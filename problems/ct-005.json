{
  "id": "ct-005",
  "title": "設定ファイルの差分影響範囲を求めよ",
  "difficulty": "hard",
  "category": ["graph", "dfs", "bfs"],
  "time_limit_sec": 2.0,
  "memory_limit_mb": 512,
  "description": "# 設定ファイルの差分影響範囲を求めよ\n\n## 問題概要\n\n設定ファイルのキー間には依存関係があります。あるキーが変更されると、そのキーに依存するすべてのキーも影響を受けます。変更されたキーの集合が与えられたとき、影響を受けるすべてのキー（変更されたキー自身も含む）を求めてください。\n\n依存関係は有向グラフで表現され、サイクルが存在する場合もあります。サイクル内のいずれかのキーが変更されると、サイクル内のすべてのキーが影響を受けます。\n\n## 入力仕様\n\n- `dependencies`: 依存関係のリスト。各要素は `(from_key, to_key)` のタプルで、`from_key` が変更されると `to_key` も影響を受けることを表す\n- `changed_keys`: 変更されたキーのリスト\n\n## 出力仕様\n\n- `set[str]`: 影響を受けるすべてのキーの集合（変更されたキー自身も含む）\n\n## 制約条件\n\n- `0 <= len(dependencies) <= 10^5`\n- `1 <= len(changed_keys) <= 10^4`\n- すべてのキーは文字列\n- キーの長さは1以上100以下\n\n## サンプル入力・出力\n\n### サンプル1（単独キー）\n\n入力:\n```python\ndependencies = []\nchanged_keys = [\"A\"]\n```\n\n出力:\n```python\n{\"A\"}\n```\n\n### サンプル2（直線依存）\n\n入力:\n```python\ndependencies = [(\"A\", \"B\"), (\"B\", \"C\")]\nchanged_keys = [\"A\"]\n```\n\n出力:\n```python\n{\"A\", \"B\", \"C\"}  # Aが変更されるとB、Cも影響を受ける\n```\n\n### サンプル3（分岐）\n\n入力:\n```python\ndependencies = [(\"A\", \"B\"), (\"A\", \"C\")]\nchanged_keys = [\"A\"]\n```\n\n出力:\n```python\n{\"A\", \"B\", \"C\"}\n```\n\n### サンプル4（サイクル）\n\n入力:\n```python\ndependencies = [(\"A\", \"B\"), (\"B\", \"C\"), (\"C\", \"A\")]\nchanged_keys = [\"B\"]\n```\n\n出力:\n```python\n{\"A\", \"B\", \"C\"}  # サイクル内のいずれかが変更されると、すべて影響を受ける\n```",
  "function_signature": "def solve(dependencies: list[tuple[str, str]], changed_keys: list[str]) -> set[str]:",
  "test_code": "def test_sample1():\n    assert solve([], [\"A\"]) == {\"A\"}\n\ndef test_sample2():\n    assert solve([(\"A\", \"B\"), (\"B\", \"C\")], [\"A\"]) == {\"A\", \"B\", \"C\"}\n\ndef test_sample3():\n    assert solve([(\"A\", \"B\"), (\"A\", \"C\")], [\"A\"]) == {\"A\", \"B\", \"C\"}\n\ndef test_sample4():\n    result = solve([(\"A\", \"B\"), (\"B\", \"C\"), (\"C\", \"A\")], [\"B\"])\n    assert result == {\"A\", \"B\", \"C\"}\n\ndef test_no_dependencies():\n    assert solve([], [\"X\", \"Y\"]) == {\"X\", \"Y\"}\n\ndef test_single_dependency():\n    assert solve([(\"A\", \"B\")], [\"A\"]) == {\"A\", \"B\"}\n\ndef test_multiple_start_points():\n    deps = [(\"A\", \"C\"), (\"B\", \"C\")]\n    result = solve(deps, [\"A\", \"B\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert \"C\" in result\n\ndef test_cycle_with_branch():\n    # A -> B -> C -> A, かつ B -> D\n    deps = [(\"A\", \"B\"), (\"B\", \"C\"), (\"C\", \"A\"), (\"B\", \"D\")]\n    result = solve(deps, [\"B\"])\n    assert result == {\"A\", \"B\", \"C\", \"D\"}\n\ndef test_disconnected_components():\n    deps = [(\"A\", \"B\"), (\"C\", \"D\")]\n    result = solve(deps, [\"A\"])\n    assert result == {\"A\", \"B\"}\n    assert \"C\" not in result\n    assert \"D\" not in result\n\ndef test_self_loop():\n    # 自己ループ（実質的な意味はないが、エラーにならないことを確認）\n    deps = [(\"A\", \"A\")]\n    result = solve(deps, [\"A\"])\n    assert result == {\"A\"}"
}








