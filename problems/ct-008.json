{
  "id": "ct-008",
  "title": "非同期ジョブの依存解決と実行順制御",
  "difficulty": "hard",
  "category": ["graph", "topological-sort", "simulation"],
  "time_limit_sec": 2.0,
  "memory_limit_mb": 512,
  "description": "# 非同期ジョブの依存解決と実行順制御\n\n## 問題概要\n\n複数の非同期ジョブがあり、それぞれが依存関係と実行時間を持っています。依存が解決されたジョブは即時実行可能ですが、同時実行数に上限があります。すべてのジョブを完了するまでの最短時間を求めてください。\n\n## 入力仕様\n\n- `jobs`: ジョブのリスト。各ジョブは以下のプロパティを持つ\n  - `id`: ジョブの一意識別子（文字列）\n  - `duration`: ジョブの実行時間（正の整数、ミリ秒）\n  - `dependsOn`: このジョブが依存するジョブIDのリスト（文字列のリスト）\n- `maxConcurrency`: 同時実行可能なジョブの最大数（正の整数）\n\n## 出力仕様\n\n- `number`: すべてのジョブが完了するまでの時間（ミリ秒）\n\n## 制約条件\n\n- `1 <= len(jobs) <= 10^5`\n- `1 <= duration <= 10^4`\n- `1 <= maxConcurrency <= 10^5`\n- 依存関係に循環はない（DAG）\n- すべてのジョブIDは一意\n- `dependsOn` に含まれるIDは必ず `jobs` 内に存在する\n\n## サンプル入力・出力\n\n### サンプル1（単一ジョブ）\n\n入力:\n```typescript\njobs = [\n  { id: \"A\", duration: 5, dependsOn: [] }\n]\nmaxConcurrency = 1\n```\n\n出力:\n```typescript\n5\n```\n\n### サンプル2（直列依存）\n\n入力:\n```typescript\njobs = [\n  { id: \"A\", duration: 2, dependsOn: [] },\n  { id: \"B\", duration: 3, dependsOn: [\"A\"] },\n  { id: \"C\", duration: 4, dependsOn: [\"B\"] }\n]\nmaxConcurrency = 2\n```\n\n出力:\n```typescript\n9  // A(2) -> B(3) -> C(4) = 2 + 3 + 4 = 9\n```\n\n### サンプル3（並列制御）\n\n入力:\n```typescript\njobs = [\n  { id: \"A\", duration: 3, dependsOn: [] },\n  { id: \"B\", duration: 2, dependsOn: [] },\n  { id: \"C\", duration: 5, dependsOn: [\"A\", \"B\"] }\n]\nmaxConcurrency = 1\n```\n\n出力:\n```typescript\n10  // A(3) -> B(2) -> C(5) = 3 + 2 + 5 = 10（同時実行数が1のため順次実行）\n```\n\n### サンプル4（並列実行）\n\n入力:\n```typescript\njobs = [\n  { id: \"A\", duration: 3, dependsOn: [] },\n  { id: \"B\", duration: 2, dependsOn: [] },\n  { id: \"C\", duration: 5, dependsOn: [\"A\", \"B\"] }\n]\nmaxConcurrency = 2\n```\n\n出力:\n```typescript\n8  // A(3)とB(2)を並列実行（max(3,2)=3）、その後C(5)を実行 = 3 + 5 = 8\n```",
  "function_signature": "def solve(jobs: list[dict], maxConcurrency: int) -> int:",
  "test_code": "def test_sample1():\n    jobs = [{\"id\": \"A\", \"duration\": 5, \"dependsOn\": []}]\n    assert solve(jobs, 1) == 5\n\ndef test_sample2():\n    jobs = [\n        {\"id\": \"A\", \"duration\": 2, \"dependsOn\": []},\n        {\"id\": \"B\", \"duration\": 3, \"dependsOn\": [\"A\"]},\n        {\"id\": \"C\", \"duration\": 4, \"dependsOn\": [\"B\"]}\n    ]\n    assert solve(jobs, 2) == 9\n\ndef test_sample3():\n    jobs = [\n        {\"id\": \"A\", \"duration\": 3, \"dependsOn\": []},\n        {\"id\": \"B\", \"duration\": 2, \"dependsOn\": []},\n        {\"id\": \"C\", \"duration\": 5, \"dependsOn\": [\"A\", \"B\"]}\n    ]\n    assert solve(jobs, 1) == 10\n\ndef test_sample4():\n    jobs = [\n        {\"id\": \"A\", \"duration\": 3, \"dependsOn\": []},\n        {\"id\": \"B\", \"duration\": 2, \"dependsOn\": []},\n        {\"id\": \"C\", \"duration\": 5, \"dependsOn\": [\"A\", \"B\"]}\n    ]\n    assert solve(jobs, 2) == 8\n\ndef test_no_dependencies():\n    jobs = [\n        {\"id\": \"A\", \"duration\": 1, \"dependsOn\": []},\n        {\"id\": \"B\", \"duration\": 2, \"dependsOn\": []},\n        {\"id\": \"C\", \"duration\": 3, \"dependsOn\": []}\n    ]\n    assert solve(jobs, 3) == 3\n    assert solve(jobs, 1) == 6\n\ndef test_fork_join():\n    jobs = [\n        {\"id\": \"A\", \"duration\": 1, \"dependsOn\": []},\n        {\"id\": \"B\", \"duration\": 2, \"dependsOn\": [\"A\"]},\n        {\"id\": \"C\", \"duration\": 3, \"dependsOn\": [\"A\"]},\n        {\"id\": \"D\", \"duration\": 4, \"dependsOn\": [\"B\", \"C\"]}\n    ]\n    result = solve(jobs, 2)\n    # A(1) -> B(2),C(3)並列(max=3) -> D(4) = 1 + 3 + 4 = 8\n    assert result == 8\n\ndef test_complex_dag():\n    jobs = [\n        {\"id\": \"A\", \"duration\": 1, \"dependsOn\": []},\n        {\"id\": \"B\", \"duration\": 2, \"dependsOn\": []},\n        {\"id\": \"C\", \"duration\": 3, \"dependsOn\": [\"A\", \"B\"]},\n        {\"id\": \"D\", \"duration\": 4, \"dependsOn\": [\"C\"]},\n        {\"id\": \"E\", \"duration\": 5, \"dependsOn\": [\"C\"]}\n    ]\n    result = solve(jobs, 2)\n    # A(1),B(2)並列(max=2) -> C(3) -> D(4),E(5)並列(max=5) = 2 + 3 + 5 = 10\n    assert result == 10",
  "supported_languages": ["python", "typescript"]
}







