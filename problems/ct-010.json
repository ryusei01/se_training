{
  "id": "ct-010",
  "title": "設定依存グラフの影響範囲解析",
  "difficulty": "hard",
  "category": ["graph", "dfs", "bfs"],
  "time_limit_sec": 2.0,
  "memory_limit_mb": 512,
  "description": "# 設定依存グラフの影響範囲解析\n\n## 問題概要\n\n設定キー間の依存関係が与えられます。変更されたキーから影響を受ける全キーを列挙してください。\n\n依存関係は有向グラフで表現され、`A -> B` は「Aが変更されるとBも影響を受ける」ことを意味します。循環依存が存在する場合、循環内のいずれかのキーが変更されると、循環内のすべてのキーが影響を受けます。\n\n## 入力仕様\n\n- `dependencies`: 依存関係のリスト。各要素は `[from_key, to_key]` のタプルで、`from_key` が変更されると `to_key` も影響を受けることを表す\n- `changedKeys`: 変更されたキーのリスト\n\n## 出力仕様\n\n- `list[str]`: 影響を受けるすべてのキーのリスト（変更されたキー自身も含む）。重複は除去され、任意の順序で返される\n\n## 制約条件\n\n- `0 <= len(dependencies) <= 10^5`\n- `1 <= len(changedKeys) <= 10^4`\n- すべてのキーは文字列\n- キーの長さは1以上100以下\n- 循環依存が存在する可能性がある\n\n## サンプル入力・出力\n\n### サンプル1（単独キー）\n\n入力:\n```typescript\ndependencies = []\nchangedKeys = [\"A\"]\n```\n\n出力:\n```typescript\n[\"A\"]\n```\n\n### サンプル2（直線依存）\n\n入力:\n```typescript\ndependencies = [[\"A\", \"B\"], [\"B\", \"C\"]]\nchangedKeys = [\"A\"]\n```\n\n出力:\n```typescript\n[\"A\", \"B\", \"C\"]  # Aが変更されるとB、Cも影響を受ける\n```\n\n### サンプル3（分岐）\n\n入力:\n```typescript\ndependencies = [[\"A\", \"B\"], [\"A\", \"C\"]]\nchangedKeys = [\"A\"]\n```\n\n出力:\n```typescript\n[\"A\", \"B\", \"C\"]\n```\n\n### サンプル4（循環依存）\n\n入力:\n```typescript\ndependencies = [[\"A\", \"B\"], [\"B\", \"C\"], [\"C\", \"A\"]]\nchangedKeys = [\"B\"]\n```\n\n出力:\n```typescript\n[\"A\", \"B\", \"C\"]  # 循環内のいずれかが変更されると、すべて影響を受ける\n```",
  "function_signature": "def solve(dependencies: list[tuple[str, str]], changedKeys: list[str]) -> list[str]:",
  "test_code": "def test_sample1():\n    result = solve([], [\"A\"])\n    assert \"A\" in result\n    assert len(result) == 1\n\ndef test_sample2():\n    deps = [[\"A\", \"B\"], [\"B\", \"C\"]]\n    result = solve(deps, [\"A\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert \"C\" in result\n    assert len(result) == 3\n\ndef test_sample3():\n    deps = [[\"A\", \"B\"], [\"A\", \"C\"]]\n    result = solve(deps, [\"A\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert \"C\" in result\n    assert len(result) == 3\n\ndef test_sample4():\n    deps = [[\"A\", \"B\"], [\"B\", \"C\"], [\"C\", \"A\"]]\n    result = solve(deps, [\"B\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert \"C\" in result\n    assert len(result) == 3\n\ndef test_no_dependencies():\n    result = solve([], [\"X\", \"Y\"])\n    assert \"X\" in result\n    assert \"Y\" in result\n    assert len(result) == 2\n\ndef test_single_dependency():\n    result = solve([[\"A\", \"B\"]], [\"A\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert len(result) == 2\n\ndef test_multiple_start_points():\n    deps = [[\"A\", \"C\"], [\"B\", \"C\"]]\n    result = solve(deps, [\"A\", \"B\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert \"C\" in result\n    assert len(result) == 3\n\ndef test_cycle_with_branch():\n    # A -> B -> C -> A, かつ B -> D\n    deps = [[\"A\", \"B\"], [\"B\", \"C\"], [\"C\", \"A\"], [\"B\", \"D\"]]\n    result = solve(deps, [\"B\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert \"C\" in result\n    assert \"D\" in result\n    assert len(result) == 4\n\ndef test_disconnected_components():\n    deps = [[\"A\", \"B\"], [\"C\", \"D\"]]\n    result = solve(deps, [\"A\"])\n    assert \"A\" in result\n    assert \"B\" in result\n    assert \"C\" not in result\n    assert \"D\" not in result\n\ndef test_no_duplicates():\n    # 結果に重複がないことを確認\n    deps = [[\"A\", \"B\"], [\"B\", \"A\"]]\n    result = solve(deps, [\"A\"])\n    assert len(result) == len(set(result))",
  "supported_languages": ["python", "typescript"]
}




